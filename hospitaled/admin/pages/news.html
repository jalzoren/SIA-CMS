<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/SIA-CMS/hospitaled/admin/css/news.css" />
    <link rel="stylesheet" href="/hospitaled/admin/css/global.css" />

  <link
      href="https://cdn.quilljs.com/1.3.7/quill.snow.css"
      rel="stylesheet"
    />


    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <title>Hospitaled - News</title>
  </head>
  <body>
    <!-- SIDEBAR -->
    <section id="sidebar">
      <a href="./index.html" class="brand">
        <i class="bx bx-plus icon"></i>hospitaled
      </a>

           <ul class="side-menu">
        <li>
          <a href="/SIA-CMS/hospitaled/admin/index.html"
            ><i class="bx bxs-dashboard icon"></i> Dashboard</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/announcements.html"
            ><i class="bx bxs-megaphone icon"></i> Announcements</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/news.html"  class="active"
            ><i class="bx bxs-news icon"></i> News</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/events-careers.html"
            ><i class="bx bxs-briefcase icon"></i> Events & Careers</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/health-tips.html"
            ><i class="bx bxs-heart icon"></i> Health Tips</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/posts.html">
            <i class="bx bxs-edit icon"></i> Posts
          </a>
        </li>

        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/doctors.html"
            ><i class="bx bxs-user-pin icon"></i> Doctor & Departments</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/media-library.html"
            ><i class="bx bxs-camera icon"></i> Media Library</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/about-hospital.html"
            ><i class="bx bxs-building-house icon"></i> About Hospital</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/analytics-reports.html"
            ><i class="bx bxs-bar-chart-alt-2 icon"></i> Analytics & Reports</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/messaging.html"
            ><i class="bx bxs-envelope icon"></i> Messaging</a
          >
        </li>
        <li>
          <a href="/SIA-CMS/hospitaled/admin/pages/settings.html"
            ><i class="bx bxs-cog icon"></i> Settings</a
          >
        </li>
      </ul>
    </section>

    <!-- NAVBAR -->
    <section id="content">
      <nav>
        <i class="bx bx-menu toggle-sidebar"></i>
        <h1>Welcome, Admin Lorem!</h1>
      </nav>

      <!-- MAIN -->
      <main>
        <h1 class="title">News</h1>
        <ul class="breadcrumbs">
          <li><a href="#">News</a></li>
          <li class="divider">/</li>
          <li><a href="#" class="active">Dashboard</a></li>
        </ul>

        <div class="card announcement-card">
          <div class="head">
            <p class="announcement-title">Create a News Article</p>

            <div class="announcement-actions">
              <button class="btn draft">Save as Draft</button>
                <!-- Schedule and Submit Buttons
              <button class="btn schedule">
                <i class="fa fa-calendar"></i> Schedule Post
              </button>

            -->
              
              <button class="btn submit">Submit</button>
            </div>
          </div>
        </div>

        <!-- âœ… News Form -->
        <div class="card big-card">
          <form class="announcement-form">
            <!-- 3 Columns -->
            <div class="form-row">
              <div class="form-group">
                <label for="short-title">Short Title</label>
                <input
                  type="text"
                  id="short-title"
                  placeholder="Enter short title"
                />
              </div>

              <div class="form-group">
                <label for="full-title">Full Title</label>
                <input
                  type="text"
                  id="full-title"
                  placeholder="Enter full title"
                />
              </div>

              <div class="form-group">
                <label for="topic-tags">Topic Tags</label>
                <input
                  type="text"
                  id="topic-tags"
                  placeholder="e.g. Event, Reminder, Holiday"
                />
              </div>
            </div>

           <div class="form-group">
              <label for="quillEditor">Description Box</label>
              <div id="quillEditor" style="height: 300px"></div>
            </div>
          </form>
        </div>
      </main>
    </section>

    <!-- JS -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="/hospitaled/admin/js/main.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="/hospitaled/admin/js/main.js"></script>
    <script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>

    <script>
document.addEventListener("DOMContentLoaded", function () {
  var quill = new Quill("#quillEditor", {
    placeholder: "Write your announcement description here...",
    theme: "snow",
    modules: {
      toolbar: [
        [{ header: [1, 2, false] }],
        ["bold", "italic", "underline", "clean"],
        [{ list: "ordered" }, { list: "bullet" }],
        ["link", "image"],
        ["code-block"],
      ],
    },
  });

  const draftBtn  = document.querySelector(".btn.draft");
  const submitBtn = document.querySelector(".btn.submit");

  draftBtn.addEventListener("click", () => saveNews("draft"));
  submitBtn.addEventListener("click", () => saveNews("published"));

  function saveNews(status) {
    const shortTitle = document.getElementById("short-title").value.trim();
    const fullTitle = document.getElementById("full-title").value.trim();
    const topicTags = document.getElementById("topic-tags").value.trim();
    const description = quill.root.innerHTML;

    if (!shortTitle || !fullTitle) {
      Swal.fire({
        icon: "warning",
        title: "Incomplete Fields",
        text: "Please fill in both the short and full title fields.",
      });
      return;
    }

    // Show loading dialog
    Swal.fire({
      title: "Saving...",
      text: "Please wait while we save your article.",
      allowOutsideClick: false,
      didOpen: () => Swal.showLoading(),
    });

    fetch("/SIA-CMS/hospitaled/admin/php/save_news.php", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        short_title: shortTitle,
        full_title: fullTitle,
        topic_tags: topicTags,
        description: description,
        status: status,
      }),
    })
      .then((res) => res.json())
      .then((data) => {
        Swal.close();
        if (data.success) {
          Swal.fire({
            icon: "success",
            title: "Success!",
            text: data.message,
            showConfirmButton: false,
            timer: 2000,
          });
          document.querySelector("form.announcement-form").reset();
          quill.setContents([]);
        } else {
          Swal.fire({
            icon: "error",
            title: "Failed to Save",
            text: data.message,
          });
        }
      })
      .catch((err) => {
        Swal.close();
        Swal.fire({
          icon: "error",
          title: "Network Error",
          text: err.message,
        });
      });
  }
});
    </script>
  </body>
</html>
